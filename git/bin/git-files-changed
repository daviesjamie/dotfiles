#!/usr/bin/env bash
set -e

MERGE_BASE=$1
BRANCH=$2

if [[ -z "$MERGE_BASE" ]]; then
  MERGE_BASE=$(git symbolic-ref refs/remotes/origin/HEAD | sed 's@^refs/remotes/origin/@@')
fi

if [[ -z "$BRANCH" ]]; then
  BRANCH="HEAD"
fi

if [[ -z "$MERGE_BASE" || -z "$BRANCH" ]]; then
  echo "Usage: git files-changed [merge_base] [branch]"
  exit 1
fi

git diff --name-only $(git merge-base $MERGE_BASE $BRANCH) | sort
